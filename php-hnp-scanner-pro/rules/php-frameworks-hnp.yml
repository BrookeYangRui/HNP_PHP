rules:
  # Laravel Framework Rules
  - id: laravel-hnp-url-helper
    languages: [php]
    message: Laravel HNP - url() helper without pinned base URL
    severity: ERROR
    patterns:
      - pattern: url(...)
  
  - id: laravel-hnp-asset-helper
    languages: [php]
    message: Laravel HNP - asset() helper without pinned base URL
    severity: ERROR
    patterns:
      - pattern: asset(...)
  
  - id: laravel-hnp-redirect
    languages: [php]
    message: Laravel HNP - redirect() without pinned base URL
    severity: ERROR
    patterns:
      - pattern: redirect(...)
  
  - id: laravel-hnp-route-helper
    languages: [php]
    message: Laravel HNP - route() helper without pinned base URL
    severity: ERROR
    patterns:
      - pattern: route(...)
  
  # Symfony Framework Rules
  - id: symfony-hnp-url-generator
    languages: [php]
    message: Symfony HNP - UrlGenerator without trusted hosts
    severity: ERROR
    patterns:
      - pattern: $this->generateUrl(...)
      - pattern: $urlGenerator->generate(...)
  
  - id: symfony-hnp-redirect-response
    languages: [php]
    message: Symfony HNP - RedirectResponse without trusted hosts
    severity: ERROR
    patterns:
      - pattern: new RedirectResponse(...)
  
  - id: symfony-hnp-request-host
    languages: [php]
    message: Symfony HNP - Request->getHost() usage
    severity: ERROR
    patterns:
      - pattern: $request->getHost()
      - pattern: $this->getRequest()->getHost()
  
  # WordPress Framework Rules
  - id: wordpress-hnp-home-url
    languages: [php]
    message: WordPress HNP - home_url() without WP_HOME constant
    severity: ERROR
    patterns:
      - pattern: home_url(...)
      - pattern: get_home_url(...)
  
  - id: wordpress-hnp-site-url
    languages: [php]
    message: WordPress HNP - site_url() without WP_SITEURL constant
    severity: ERROR
    patterns:
      - pattern: site_url(...)
      - pattern: get_site_url(...)
  
  - id: wordpress-hnp-wp-redirect
    languages: [php]
    message: WordPress HNP - wp_redirect() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: wp_redirect(...)
  
  # CodeIgniter Framework Rules
  - id: codeigniter-hnp-base-url
    languages: [php]
    message: CodeIgniter HNP - base_url() without config
    severity: ERROR
    patterns:
      - pattern: base_url(...)
      - pattern: $this->config->base_url(...)
  
  - id: codeigniter-hnp-site-url
    languages: [php]
    message: CodeIgniter HNP - site_url() without config
    severity: ERROR
    patterns:
      - pattern: site_url(...)
      - pattern: $this->config->site_url(...)
  
  - id: codeigniter-hnp-redirect
    languages: [php]
    message: CodeIgniter HNP - redirect() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: redirect(...)
  
  # CakePHP Framework Rules
  - id: cakephp-hnp-url-helper
    languages: [php]
    message: CakePHP HNP - Url::build() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: Url::build(...)
      - pattern: $this->Url->build(...)
  
  - id: cakephp-hnp-redirect
    languages: [php]
    message: CakePHP HNP - redirect() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: $this->redirect(...)
  
  # Yii2 Framework Rules
  - id: yii2-hnp-url-helper
    languages: [php]
    message: Yii2 HNP - Url::to() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: Url::to(...)
      - pattern: $this->url(...)
  
  - id: yii2-hnp-redirect
    languages: [php]
    message: Yii2 HNP - redirect() without trusted hosts
    severity: ERROR
    patterns:
      - pattern: $this->redirect(...)
  
  # Generic Framework Patterns
  - id: framework-hnp-http-host
    languages: [php]
    message: Framework HNP - $_SERVER['HTTP_HOST'] in framework context
    severity: ERROR
    patterns:
      - pattern: $_SERVER['HTTP_HOST']
  
  - id: framework-hnp-request-uri
    languages: [php]
    message: Framework HNP - $_SERVER['REQUEST_URI'] usage
    severity: ERROR
    patterns:
      - pattern: $_SERVER['REQUEST_URI']
      - pattern: $_SERVER['SCRIPT_NAME']